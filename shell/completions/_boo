#compdef boo boo-mode boo-prompt

local cmdname="${service:-${words[1]}}"
local -a themes
local -a font_presets
local -a splash_names
local -a top_commands

themes=(obsidian graphite lunar crimson matrix abyss)
font_presets=(jetbrains fira meslo hack caskaydia iosevka)
splash_names=(apple boo saturn minimal)
top_commands=(
  'mode:Show or set startup panel mode'
  'prompt:Show or set prompt backend'
  'theme:List or apply full terminal/prompt presets'
  'font:Show or set Ghostty font family/size presets'
  'opacity:Show or set Ghostty background opacity'
  'preview:Preview one theme or all themes'
  'splash:Configure startup splash art'
  'doctor:Diagnose and fix common setup issues'
  'uninstall:Remove Boo CLI/config and shell integration'
  'reload:Apply config changes to Ghostty'
  'status:Print current mode/theme/font/prompt/opacity'
  'help:Show help text'
  'obsidian:Apply obsidian theme'
  'graphite:Apply graphite theme'
  'lunar:Apply lunar theme'
  'crimson:Apply crimson theme'
  'matrix:Apply matrix theme'
  'abyss:Apply abyss theme'
)

case "$cmdname" in
  boo-mode)
    if (( CURRENT == 2 )); then
      _values 'mode' full public
    fi
    return
    ;;
  boo-prompt)
    if (( CURRENT == 2 )); then
      _values 'prompt backend' native omp
    fi
    return
    ;;
  *)
    ;;
esac

if (( CURRENT == 2 )); then
  _describe -t commands 'boo command' top_commands
  return
fi

case "${words[2]}" in
  mode)
    if (( CURRENT == 3 )); then
      _values 'mode' full public
    fi
    ;;
  prompt)
    if (( CURRENT == 3 )); then
      _values 'prompt action' show list set status native omp
    elif (( CURRENT == 4 )) && [[ "${words[3]}" == "set" ]]; then
      _values 'prompt backend' native omp
    fi
    ;;
  theme)
    if (( CURRENT == 3 )); then
      _values 'theme action' list set "${themes[@]}"
    elif (( CURRENT == 4 )) && [[ "${words[3]}" == "set" ]]; then
      _values 'theme' "${themes[@]}"
    fi
    ;;
  font)
    case "$CURRENT" in
      3)
        _values 'font action' show status list set family size "${font_presets[@]}"
        ;;
      4)
        case "${words[3]}" in
          set)
            _values 'font set target' family size "${font_presets[@]}"
            ;;
          size)
            _values 'font size' 10 11 12 13 14 15 16 18 20 24
            ;;
          family)
            _message 'font family name'
            ;;
          *)
            _values 'font preset or size' "${font_presets[@]}" 10 11 12 13 14 15 16 18 20 24
            ;;
        esac
        ;;
      5)
        if [[ "${words[3]}" == "set" ]]; then
          case "${words[4]}" in
            size)
              _values 'font size' 10 11 12 13 14 15 16 18 20 24
              ;;
            family)
              _message 'font family name'
              ;;
            *)
              ;;
          esac
        fi
        ;;
      *)
        ;;
    esac
    ;;
  opacity)
    if (( CURRENT == 3 )); then
      _values 'opacity value' glass solid 0.30 0.50 0.70 0.85 0.92 1.00
    fi
    ;;
  preview)
    if (( CURRENT == 3 )); then
      _values 'preview target' all "${themes[@]}" --plain -p
    else
      _values 'preview option' --plain -p all "${themes[@]}"
    fi
    ;;
  splash)
    if (( CURRENT == 3 )); then
      _values 'splash action' show status list custom none reset "${splash_names[@]}"
    elif (( CURRENT == 4 )) && [[ "${words[3]}" == "custom" ]]; then
      _files
    fi
    ;;
  doctor)
    if (( CURRENT == 3 )); then
      _values 'doctor action' check fix status --fix
    fi
    ;;
  uninstall)
    if (( CURRENT == 3 )); then
      _values 'uninstall option' --yes -y yes help -h --help
    fi
    ;;
  reload)
    if (( CURRENT == 3 )); then
      _values 'reload option' --unsafe -u --safe unsafe safe
    fi
    ;;
  status|help|obsidian|graphite|lunar|crimson|matrix|abyss)
    ;;
  *)
    _describe -t commands 'boo command' top_commands
    ;;
esac
